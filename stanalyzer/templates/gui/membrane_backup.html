<script type="text/javascript">
var $j = jQuery.noConflict();
var cnt_membrane = 0;

/* check numbers */
function isNumber(n) {
    return !isNaN(parseFloat(n)) && isFinite(n);
}

key_words = [	'all',
		'protein', 'backbone', 'nucleic', 'nucleicbackbone', 'segid', 'resid',
		'resnum', 'resname', 'name', 'type', 'atom',
		'not', 'and', 'or',
		'around', 'point', 'prop',
		'<', '>', '<=', '>=', '==', '!=',
		'x', 'y', 'z'
	       ];

/* Checking syntex error for  */
function chkSyntex(query) {
    // this will have syntex check algorithm
    vfy = [];
    
    // check parenthesis pair
    var lpt = query.match(/\(/g);
    var rpt = query.match(/\)/g);
    if (lpt == null) {
	num_lpt = 0;
    } else {
	num_lpt = lpt.length;
    }
    
    if (rpt == null) {
	num_rpt = 0;
    } else {
	num_rpt = rpt.length;
    }
    
    if (num_lpt != num_rpt) {
	vfy = { 'flag': true,
		'err' : 'parenthesis is not paired',
	}
	return vfy;
    }
    
    
    // check out keywords
    /*
     * mySystem contains 'all' information about the system including
     * 'resname', 'resid', 'name', 'segid', 'type'
     * 
     */
    // alert(mySystem["all"]);
    arrQuery = query.split(' ');
    for (var i=0; i < arrQuery.length; i++) {
	// Ignoring multiple spaces
	if (arrQuery[i].length > 0) {
	    
	    qWord = arrQuery[i];
	    qWord = qWord.replace('(', '');
	    qWord = qWord.replace(')', '');
	    
	    //alert("isNumber [ " + qWord + " ]?" + isNumber(qWord));

	    if ((isNumber(qWord)) || (qWord == '')){
		continue;
	    }
	    
	    
	    useWc1 = qWord.match(/\*/g); // wild card search
	    //useWc2 = qWord.match(/\+/g); // wild card search
	    
	    //if ((useWc1 != null) || (useWc2 != null)) {
	    if (useWc1 != null) {
		pattn = qWord;
		pattns = new RegExp(pattn);
		flg_Wc = 0;
		for (var j=0; j < mySystem["all"].length; j++) {
		    rStr = mySystem["all"][j];
		    if (rStr.length > 0) {
			match_Wc = rStr.match(pattns);
			//alert('match_Wc=' + match_Wc)
			if (match_Wc != null) {
			    if (match_Wc[0].length > 0) {
				//alert(rStr + " : " + match_Wc[0] + ": J=" + j);
				flg_Wc = 1;
				break;
			    }
			}
		    }
		}
		//alert("flg_Wc: " + flg_Wc);
		if (flg_Wc == 0) {
		    //var msg = flg_match + " : '" + qWord + "' is unknown";
		    var msg = qWord + "' is unknown";
		    vfy = { 'flag': true,
			'err' : msg,
		    }
		    return vfy;
		}
	    } else {
		qWord = qWord.replace('(', '');
		qWord = qWord.replace(')', '');
		var flg_match = $j.inArray(qWord, mySystem["all"]);
		//var msg = flg_match + " : '" + qWord + "' is unknown";
		var msg = qWord + "' is unknown";
		if (flg_match < 0) {
		    vfy = { 'flag': true,
			    'err' : msg,
		    }
		    return vfy;
		}
	    } 
	}
    }
    
    return false;
};

/* read structure file (PDB) and return unqiue contents */
function getStructureInfo(query, async_flg) {
    var bpath = $j("#proot option:selected").text();
    var stfile = $j("#stfile option:selected").text();
    var pdbfile = $j("#pdbfile option:selected").text();
    var stInfo = [];
    var systemInfo = {
	'all' 		: stInfo,
    }
    var sndData = {
	'cmd'       : 'getStructure',
	'query'	    : query,
	'bpath'	    : bpath,
	'stfile'    : stfile,
	'pdbfile'   : pdbfile,
    }

    var request = $j.ajax({
    type: "POST",
    url: '/gui/getStructureInfo/',
    cache: false,
    data: sndData,
    async: async_flg,
    });
		
    request.done(function(Jdata) {
	var obj = $j.parseJSON(Jdata);
	var key_words_tmp = $.merge([], key_words);		// duplicate first array to prevent changing original array
	stInfo = $j.merge(key_words_tmp, obj.uq_resname); 	// unqiue residue name
	stInfo = $j.merge(stInfo, obj.uq_resid);		// unique residue IDs
	stInfo = $j.merge(stInfo, obj.uq_name);		// unique atom names
	stInfo = $j.merge(stInfo, obj.uq_segid);	// unique segment IDs
	stInfo = $j.merge(stInfo, obj.uq_type);		// unique types
	systemInfo['all']     = stInfo;
	systemInfo['resname'] = obj.uq_resname;
	systemInfo['resid']   = obj.uq_resid;
	systemInfo['name']    = obj.uq_name;
	systemInfo['segid']   = obj.uq_segid;
	systemInfo['type']    = obj.uq_type;
	systemInfo['crd_min'] = obj.crd_min;
	systemInfo['crd_max'] = obj.crd_max;
	systemInfo['num_atoms'] = obj.num_atoms;
	
	/* fill out the information about density min and max */
	var smin = 0;
	var smax = 0;
	if (Math.abs(obj.crd_min) > Math.abs(obj.crd_max)) {
	    smin = obj.crd_min;
	    smax = Math.abs(obj.crd_min);
	} else {
	    smin = -1 * obj.crd_max;
	    smax = obj.crd_max;
	}
	$j("#membrane #density #density_form #density_hist_min").empty().val(smin);
	$j("#membrane #density #density_form #density_hist_max").empty().val(smax);
	$j("#membrane #density #density_form #density_hist_tatoms").empty().val(obj.num_atoms);
    });
      
    request.error(function(jqXHR, textStatus, errorThrown) {
	$j("#vfy_msg").empty().append("Error: PDB file cannot be read!");
    });

    return systemInfo;
}

var mySystem;		// this gloabl value is defined in 'index.html' when $j('.next-tab').click() is trigged!

/* ##########################################
 * Main function starts
 * ########################################## */
$j(document).ready(function(){
    $j("#M_membrane").hide();
    $j("#chk_membrane").click(function () {
	$j("#M_membrane").toggle(this.checked);
    });
/*
    $j("#membrane #density #density_title").click(function() {
	var chk = $j(this).prop('checked');
	if (chk == true) {
	    cnt_membrane++;
	} else {
	    cnt_membrane--;
	    if (cnt_membrane < 0) {
		cnt_membrane = 0;
	    }
	}
	$j("#membrane #cnt_membrane").empty().append(cnt_membrane);
    });
*/
    $j("#membrane #density #chk_density_all").click(function() {
	var chk = $j(this).prop('checked');
	if (chk == true) {
	    cnt_membrane++;
	} else {
	    cnt_membrane--;
	    if (cnt_membrane < 0) {
		cnt_membrane = 0;
	    }
	}
	$j("#membrane #cnt_membrane").empty().append(cnt_membrane);
    });

    $j("#membrane #density #chk_density_lipidH").click(function() {
	var chk = $j(this).prop('checked');
	if (chk == true) {
	    cnt_membrane++;
	} else {
	    cnt_membrane--;
	    if (cnt_membrane < 0) {
		cnt_membrane = 0;
	    }
	}
	$j("#membrane #cnt_membrane").empty().append(cnt_membrane);
    });
  
    $j("#membrane #density #chk_density_lipidT").click(function() {
	var chk = $j(this).prop('checked');
	if (chk == true) {
	    cnt_membrane++;
	} else {
	    cnt_membrane--;
	    if (cnt_membrane < 0) {
		cnt_membrane = 0;
	    }
	}
	$j("#membrane #cnt_membrane").empty().append(cnt_membrane);
    });
      
      $j("#membrane #density #chk_density_water").click(function() {
	var chk = $j(this).prop('checked');
	if (chk == true) {
	    cnt_membrane++;
	} else {
	    cnt_membrane--;
	    if (cnt_membrane < 0) {
		cnt_membrane = 0;
	    }
	}
	$j("#membrane #cnt_membrane").empty().append(cnt_membrane);
    });
      
      $j("#membrane #density #chk_density_waterdp").click(function() {
	var chk = $j(this).prop('checked');
	if (chk == true) {
	    cnt_membrane++;
	} else {
	    cnt_membrane--;
	    if (cnt_membrane < 0) {
		cnt_membrane = 0;
	    }
	}
	$j("#membrane #cnt_membrane").empty().append(cnt_membrane);
    });

    $j("#membrane #density #chk_density_vector").click(function() {
	var chk = $j(this).prop('checked');
	if (chk == true) {
	    cnt_membrane++;
	} else {
	    cnt_membrane--;
	    if (cnt_membrane < 0) {
		cnt_membrane = 0;
	    }
	}
	$j("#membrane #cnt_membrane").empty().append(cnt_membrane);
    });

    $j("#membrane #density #chk_density_custom").click(function() {
	var chk = $j(this).prop('checked');
	if (chk == true) {
	    cnt_membrane++;
	} else {
	    cnt_membrane--;
	    if (cnt_membrane < 0) {
		cnt_membrane = 0;
	    }
	}
	$j("#membrane #cnt_membrane").empty().append(cnt_membrane);
    });
   
    $j('#membrane #density #density_frmInt').val('1').css("color", "gray");
    $j('#membrane #density #density_frm_all #density_outFile').val('density_all.dat').css("color", "gray");
    $j('#membrane #density #density_frm_lipidH #density_outFile').val('density_lipid_head.dat').css("color", "gray");
    $j('#membrane #density #density_frm_lipidT #density_outFile').val('density_lipid_tail.dat').css("color", "gray");
    $j('#membrane #density #density_frm_water #density_outFile').val('density_water.dat').css("color", "gray");
    $j('#membrane #density #density_frm_waterdp #density_outFile').val('density_water_dipole.dat').css("color", "gray");
    $j('#membrane #density #density_frm_vector #density_outFile').val('density_vector.dat').css("color", "gray");
    $j('#membrane #density #density_frm_custom #density_outFile').val('density_custom.dat').css("color", "gray");

    $j("#membrane #density #density_form").hide();
    $j("#membrane #density #density_title").click(function () {
	$j("#vfy_msg").empty();
	if (this.checked) {
	    // reading PDB file and extract information
	    // msg = "<img src='/static/images/circle2.gif' height='20' width='20' > Reading structure information... "
	    // $j("#systemInfo #density #density_read_pdb").append(msg);
	    //mySystem  = getStructureInfo('all', true);
	}

	$j("#membrane #density #density_form").toggle(this.checked);
	//alert($j(this).is(":checked"));
    });


    
    /* ##########################################
     * Density
     * ########################################## */
    $j("#membrane #density #density_frm_all").hide();
    $j("#membrane #density #chk_density_all").click(function () {
	$j("#membrane #density #density_frm_all").toggle(this.checked);
    });

    $j("#membrane #density #density_frm_lipidH").hide();
    $j("#membrane #density #chk_density_lipidH").click(function () {
	$j("#membrane #density #density_frm_lipidH").toggle(this.checked);
    });

    $j("#membrane #density #density_frm_lipidT").hide();
    $j("#membrane #density #chk_density_lipidT").click(function () {
	$j("#membrane #density #density_frm_lipidT").toggle(this.checked);
    });

    $j("#membrane #density #density_frm_water").hide();
    $j("#membrane #density #chk_density_water").click(function () {
	$j("#membrane #density #density_frm_water").toggle(this.checked);
    });

    $j("#membrane #density #density_frm_waterdp").hide();
    $j("#membrane #density #chk_density_waterdp").click(function () {
	$j("#membrane #density #density_frm_waterdp").toggle(this.checked);
    });

    $j("#membrane #density #density_frm_vector").hide();
    $j("#membrane #density #chk_density_vector").click(function () {
	$j("#membrane #density #density_frm_vector").toggle(this.checked);
    });

    $j("#membrane #density #density_frm_custom").hide();
    $j("#membrane #density #chk_density_custom").click(function () {
	$j("#membrane #density #density_frm_custom").toggle(this.checked);
    });

    // Loading initial values
    $j("#membrane #density #density_form #density_hist_min").empty().val('Loading...').css("color", "gray");
    $j("#membrane #density #density_form #density_hist_max").empty().val('Loading...').css("color", "gray");
    $j("#membrane #density #density_form #density_hist_bin").empty().val('1');
    $j("#membrane #density #density_form #density_frm_all #density_query").empty().val('all');
    $j("#membrane #density #density_form #density_frm_lipidH #density_query").empty().val('segid MEMB and ( name P or name N or (name C1* and not name C1) or name O1* )');
    $j("#membrane #density #density_form #density_frm_lipidT #density_query").empty().val('segid MEMB and ( name C2* or name C3* ) and not ( name C21 or  name C31 )');
    $j("#membrane #density #density_form #density_frm_water #density_query").empty().val('segid TIP3 and name OH2');
    $j("#membrane #density #density_form #density_frm_waterdp #density_query").empty().val('waterdp');
    $j("#membrane #density #density_form #density_frm_vector #density_query").empty().val('vector');
    $j("#membrane #density #density_form #density_frm_custom #density_query").empty().val('custom');
    
    // Buttons
    $j("#btn_selall").button();
    $j("#btn_lt").button();
    $j("#btn_gt").button();
    $j("#btn_eq").button();
    $j("#btn_ne").button();
    $j("#btn_ge").button();
    $j("#btn_le").button();
    $j("#btn_and").button();
    $j("#btn_or").button();
    $j("#btn_not").button();
    $j("#btn_around").button();
    $j("#btn_query_segid").button();
    $j("#btn_query_resname").button();
    $j("#btn_query_resid").button();
    $j("#btn_query_name").button();
    $j("#btn_query_type").button();
    $j("#btn_query_prop").button();

    // click btn_lt button
    $j("#membrane #density #density_frm_custom #btn_selall").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "ALL ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });

    $j("#membrane #density #density_frm_custom #btn_lt").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "< ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });

    // click btn_gt button 
    $j("#membrane #density #density_frm_custom #btn_gt").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "> ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });
    
    // click btn_eq button 
    $j("#membrane #density #density_frm_custom #btn_eq").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "== ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });
    
    // click btn_ne button 
    $j("#membrane #density #density_frm_custom #btn_ne").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "!= ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });
    
    // click btn_ge button 
    $j("#membrane #density #density_frm_custom #btn_ge").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + ">= ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });
    
    // click btn_le button 
    $j("#membrane #density #density_frm_custom #btn_le").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "<= ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });
    
    // click btn_and button 
    $j("#membrane #density #density_frm_custom #btn_and").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "and ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });
    
    // click btn_or button 
    $j("#membrane #density #density_frm_custom #btn_or").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "or ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });
    
    // click btn_not button 
    $j("#membrane #density #density_frm_custom #btn_not").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "not ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });
    
    // click btn_around button 
    $j("#membrane #density #density_frm_custom #btn_around").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "around ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });

    // click btn_query_segid button 
    $j("#membrane #density #density_frm_custom #btn_query_segid").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "segid ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });

    // click btn_query_resname button 
    $j("#membrane #density #density_frm_custom #btn_query_resname").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "resname ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });

    // click btn_query_resid button 
    $j("#membrane #density #density_frm_custom #btn_query_resid").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "resid ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });

    // click btn_query_name button 
    $j("#membrane #density #density_frm_custom #btn_query_name").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "name ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });

    // click btn_query_type button 
    $j("#membrane #density #density_frm_custom #btn_query_type").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "type ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });

    // click btn_query_prop button 
    $j("#membrane #density #btn_query_prop").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	new_query = query + "prop ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });
    
    $j("#membrane #density #density_frm_custom #density_gui_input").hide();
    $j("#membrane #density #density_frm_custom #density_gquery").click(function () {
	if (this.checked){
	    // make list of input forms
	    // keywords
	    $j("#membrane #density #density_frm_custom #density_gui_input #keywords").empty().append("<option>Key Words</option>");
	    for (var i = 0; i < key_words.length; i++) {
		options = "<option>" + key_words[i] + "</option>";
		$j("#membrane #density #density_frm_custom #density_gui_input #keywords").append(options);
	    }
	    $j("#membrane #density #density_frm_custom #density_gui_input #keywords").trigger("liszt:updated");
	    
	    // segid
	    $j("#membrane #density #density_frm_custom #density_gui_input #uq_segid").empty().append("<option>segid</option>");
	    uq_segid = mySystem["segid"];
	    for (var i = 0; i < uq_segid.length; i++) {
		options = "<option>" + uq_segid[i] + "</option>";
		$j("#membrane #density #density_frm_custom #density_gui_input #uq_segid").append(options);
	    }
	    $j("#membrane #density #density_frm_custom #density_gui_input #uq_segid").trigger("liszt:updated");
	    
	}
	$j("#membrane #density #density_frm_custom #density_gui_input").toggle(this.checked);
    });
    
    // add segid in query
    $j("#membrane #density #density_frm_custom #btn_add_keywords").click(function(){
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	tmp = $j("#membrane #density #density_frm_custom #density_gui_input #keywords option:selected").text();
	new_query = query + tmp + " ";
	 $j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });
    
    // click segid button 
    $j("#membrane #density #density_frm_custom #btn_add_segid").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	tmp = $j("#membrane #density #density_frm_custom #density_gui_input #uq_segid option:selected").text();
	new_query = query + tmp + " ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
	if (tmp != 'segid') {
	    //$j("#membrane #density #st_load").empty().append("<img src='/static/images/circle2.gif' height='20' width='20' >");
	    var query = "segid " + tmp;
	    tmpSystem = getStructureInfo(query, false);
	    //$j("#membrane #density #st_load").empty();
	    // resname
	    $j("#membrane #density #density_frm_custom #density_gui_input #uq_resname").empty().append("<option>resname</option>");
	    uq_resname = tmpSystem["resname"];
	    for (var i = 0; i < uq_resname.length; i++) {
		options = "<option>" + uq_resname[i] + "</option>";
		$j("#membrane #density #density_frm_custom #density_gui_input #uq_resname").append(options);
	    }
	    $j("#membrane #density #density_frm_custom #density_gui_input #uq_resname").trigger("liszt:updated");

	    // resid
	    $j("#membrane #density #density_frm_custom #density_gui_input #uq_resid").empty().append("<option>resid</option>");
	    uq_resid = tmpSystem["resid"];
	    for (var i = 0; i < uq_resid.length; i++) {
		options = "<option>" + uq_resid[i] + "</option>";
		$j("#membrane #density #density_frm_custom #density_gui_input #uq_resid").append(options);
	    }
	    $j("#membrane #density #density_frm_custom #density_gui_input #uq_resid").trigger("liszt:updated");

	    // name
	    $j("#membrane #density #density_frm_custom #density_gui_input #uq_name").empty().append("<option>name</option>");
	    uq_name = tmpSystem["name"];
	    for (var i = 0; i < uq_name.length; i++) {
		options = "<option>" + uq_name[i] + "</option>";
		$j("#membrane #density #density_frm_custom #density_gui_input #uq_name").append(options);
	    }
	    $j("#membrane #density #density_frm_custom #density_gui_input #uq_name").trigger("liszt:updated");

	    // type
	    $j("#membrane #density #density_frm_custom #density_gui_input #uq_type").empty().append("<option>type</option>");
	    uq_type = tmpSystem["type"];
	    for (var i = 0; i < uq_type.length; i++) {
		options = "<option>" + uq_type[i] + "</option>";
		$j("#membrane #density #density_frm_custom #density_gui_input #uq_type").append(options);
	    }
	    $j("#membrane #density #density_frm_custom #density_gui_input #uq_type").trigger("liszt:updated");
	}
    });
    
    // click resname button 
    $j("#membrane #density #density_frm_custom #btn_add_resname").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	tmp = $j("#membrane #density #density_frm_custom #density_gui_input #uq_resname option:selected").text();
	new_query = query + tmp + " ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });

    // click resid button 
    $j("#membrane #density #density_frm_custom #btn_add_resid").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	tmp = $j("#membrane #density #density_frm_custom #density_gui_input #uq_resid option:selected").text();
	new_query = query + tmp + " ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });

    // click name button 
    $j("#membrane #density #density_frm_custom #btn_add_name").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	tmp = $j("#membrane #density #density_frm_custom #density_gui_input #uq_name option:selected").text();
	new_query = query + tmp + " ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });
    
    // click type button 
    $j("#membrane #density #density_frm_custom #btn_add_type").click(function(){
	$j("#membrane #density #density_form #density_frm_custom #vfy_msg").empty();
	query = $j("#membrane #density #density_frm_custom #density_query").val();
	tmp = $j("#membrane #density #density_frm_custom #density_gui_input #uq_type option:selected").text();
	new_query = query + tmp + " ";
	$j("#membrane #density #density_frm_custom #density_query").val('').val(new_query);
    });

    /* Show quick menu when list box is changed */
    $j("#membrane #density #density_frm_custom #density_gui_input #keywords").live("change", function(){
	tmp_kwds = $j("#membrane #density #density_frm_custom #density_gui_input #keywords option:selected").text();
	switch (tmp_kwds)
	{
	    case "protein":
		str_help = "<b>" + tmp_kwds + "</b>: selects all atoms that belong to a standard set of residues; a protein is identfied by a hard-coded set of residue names so it may not work for esoteric residues.";
	    case "backbone":
		str_help = "<b>" + tmp_kwds + "</b>: selects all atoms that belong to a standard set of residues<br/>"
		break;
	    case "nucleic":
		str_help = "<b>" + tmp_kwds + "</b>: selects all atoms that belong to a standard set of residues<br/>"
		break;
	    case "nucleicbackbone":
		str_help = "<b>" + tmp_kwds + "</b>: selects all atoms that belong to a standard set of residues<br/>"
		break;
	    case "segid":
		str_help = "<b>" + tmp_kwds + "</b> <i>segment-name</i>: select by segment name. (e.g. segid 4AKE)"
		break;
	    case "resid":
		str_help = "<b>" + tmp_kwds + "</b> <i>residue-number(range)</i>: select by residue number or range (e.g. resid 5, resid 1:5)<br/>"
		break;
	    case "resnum":
		str_help = "<b>" + tmp_kwds + "</b> <i>residue-number(range)</i>: select by residue number in original PDB (e.g. resnum 5, resnum 1:5)<br/>"
		break;
	    case "resname":
		str_help = "<b>" + tmp_kwds + "</b> <i>residue-name</i>: select by residue name (e.g. resname LYS)<br/>"
		break;
	    case "name":
		str_help = "<b>" + tmp_kwds + "</b> <i>atom-name</i>: select by atom name as given in the topology. (e.g. <b>name CA</b>: C-alpha atom, <b>name OW</b>: SPC water oxygen)<br/>"
		break;
	    case "type":
		str_help = "<b>" + tmp_kwds + "</b> <i>atom-type</i>: select by atom type in topology file (i.e. PSF file in CHARMM) that is either a string or a number and depends on the force field<br/>"
		break;
	    case "atom":
		str_help = "<b>" + tmp_kwds + "</b> <i>segment-name residue-number atom-name</i>: a selector for a single atom consisting of segid resid atomname. (e.g. <b>DMPC 1 C2</b> : C2 carbon of the first residue of the DMPC segment<br/>"
		break;
	    case "around":
		str_help = "<b>" + tmp_kwds + "</b> <i>distance selection</i>: selects all atoms a certain cutoff away from another selection (e.g.<b>around 3.5 protein</b> all atoms not belonging to protein that are within 3.5 Angstroms from the protein<br/>"
		break;
	    case "point":
		str_help = "<b>" + tmp_kwds + "</b> <i>x y z distance</i>: selects all atoms within a cutoff of a point in space. (e.g. <b>point 5.0 5.0 5.0 3.5</b>: selects all atoms within 3.5 Angstroms of the coordinate x=5.0, y=5.0, z=5.0)<br/>"
		break;
	    case "prop":
		str_help = "<b>" + tmp_kwds + "</b> <i> [abs] property operator value</i>: selects atoms based on position, using <u>property x, y, or z</u> coordinate and <u>perators: <, >, <=, >=, ==, !=</u> (e.g. <b>prop z >= 5.0 </b>: all atoms with z coordinate >= 5.0, <b>prop abs z <= 5.0</b>: all atoms within -5.0 <= z <= 5.0)<br/>"
		break;
	}
	
	$j("#membrane #quick_help").empty().append(str_help);
    });
    
    /*******************************************
     * Verification for query
     * *****************************************/
    //---> For all 
    $j("#density_frm_all #density_btn_vfy").click(function(){
	var query = $j("#membrane #density #density_frm_all #density_query").val().trim();
	var bpath = $j("#proot option:selected").text().trim();
	var stfile = $j("#stfile option:selected").text().trim();
	var pdbfile = $j("#pdbfile option:selected").text().trim();
	
	var vfy = chkSyntex(query);
	if (vfy["flag"]) {
	    $j("#density_frm_all #vfy_msg").empty().append(vfy["err"]);
	    return false;
	}
	/* display waiting message */
	var msgWait = "Verifying the query... <img src='/static/images/circle2.gif' height='20' width='20' >"
	
	
	$j("#density_frm_all #vfy_msg").empty().append(msgWait);
	    var sndData = {
		'cmd'       : 'verify',
		'query'	    : query,
		'bpath'	    : bpath,
		'stfile'    : stfile,
		'pdbfile'   : pdbfile,
	    }

        var request = $j.ajax({
        type: "POST",
        url: '/gui/verify_query/',
        cache: false,
        data: sndData,
        //async: false,
        });
		    
        request.done(function(Jdata) {
            var obj = $j.parseJSON(Jdata);
            $j("#density_frm_all #vfy_msg").empty().append("Verified!");
            $j("#dlg_selInfo #dlg_msg").empty().append(obj.selInfo);
	    $j("#dlg_selInfo").dialog({
		resizable: true,
		modal: true,
		height:500,
                width:600,
	    });

        });
          
        request.error(function(jqXHR, textStatus, errorThrown) {
            $j("#density_frm_all #vfy_msg").empty().append(errorThrown);
        });
    });
    
    //---> For lipid head 
    $j("#density_frm_lipidH #density_btn_vfy").click(function(){
	var query = $j("#membrane #density #density_frm_lipidH #density_query").val().trim();
	var bpath = $j("#proot option:selected").text().trim();
	var stfile = $j("#stfile option:selected").text().trim();
	var pdbfile = $j("#pdbfile option:selected").text().trim();
	
	var vfy = chkSyntex(query);
	if (vfy["flag"]) {
	    $j("#density_frm_lipidH #vfy_msg").empty().append(vfy["err"]);
	    return false;
	}
	/* display waiting message */
	var msgWait = "Verifying the query... <img src='/static/images/circle2.gif' height='20' width='20' >"
	
	
	$j("#density_frm_lipidH #vfy_msg").empty().append(msgWait);
	    var sndData = {
		'cmd'       : 'verify',
		'query'	    : query,
		'bpath'	    : bpath,
		'stfile'    : stfile,
		'pdbfile'   : pdbfile,
	    }

        var request = $j.ajax({
        type: "POST",
        url: '/gui/verify_query/',
        cache: false,
        data: sndData,
        //async: false,
        });
		    
        request.done(function(Jdata) {
            var obj = $j.parseJSON(Jdata);
            $j("#density_frm_lipidH #vfy_msg").empty().append("Verified!");
            $j("#dlg_selInfo #dlg_msg").empty().append(obj.selInfo);
	    $j("#dlg_selInfo").dialog({
		resizable: true,
		modal: true,
		height:500,
                width:600,
	    });

        });
          
        request.error(function(jqXHR, textStatus, errorThrown) {
            $j("#density_frm_lipidH #vfy_msg").empty().append(errorThrown);
        });
    });
    
    //---> For lipid tail 
    $j("#density_frm_lipidT #density_btn_vfy").click(function(){
	var query = $j("#membrane #density #density_frm_lipidT #density_query").val().trim();
	var bpath = $j("#proot option:selected").text().trim();
	var stfile = $j("#stfile option:selected").text().trim();
	var pdbfile = $j("#pdbfile option:selected").text().trim();
	
	var vfy = chkSyntex(query);
	if (vfy["flag"]) {
	    $j("#density_frm_lipidT #vfy_msg").empty().append(vfy["err"]);
	    return false;
	}
	/* display waiting message */
	var msgWait = "Verifying the query... <img src='/static/images/circle2.gif' height='20' width='20' >"
	
	
	$j("#density_frm_lipidT #vfy_msg").empty().append(msgWait);
	    var sndData = {
		'cmd'       : 'verify',
		'query'	    : query,
		'bpath'	    : bpath,
		'stfile'    : stfile,
		'pdbfile'   : pdbfile,
	    }

        var request = $j.ajax({
        type: "POST",
        url: '/gui/verify_query/',
        cache: false,
        data: sndData,
        //async: false,
        });
		    
        request.done(function(Jdata) {
            var obj = $j.parseJSON(Jdata);
            $j("#density_frm_lipidT #vfy_msg").empty().append("Verified!");
            $j("#dlg_selInfo #dlg_msg").empty().append(obj.selInfo);
	    $j("#dlg_selInfo").dialog({
		resizable: true,
		modal: true,
		height:500,
                width:600,
	    });

        });
          
        request.error(function(jqXHR, textStatus, errorThrown) {
            $j("#density_frm_lipidT #vfy_msg").empty().append(errorThrown);
        });
    });

    //---> For water 
    $j("#density_frm_water #density_btn_vfy").click(function(){
	var query = $j("#membrane #density #density_frm_water #density_query").val().trim();
	var bpath = $j("#proot option:selected").text().trim();
	var stfile = $j("#stfile option:selected").text().trim();
	var pdbfile = $j("#pdbfile option:selected").text().trim();
	
	var vfy = chkSyntex(query);
	if (vfy["flag"]) {
	    $j("#density_frm_water #vfy_msg").empty().append(vfy["err"]);
	    return false;
	}
	/* display waiting message */
	var msgWait = "Verifying the query... <img src='/static/images/circle2.gif' height='20' width='20' >"
	
	
	$j("#density_frm_water #vfy_msg").empty().append(msgWait);
	    var sndData = {
		'cmd'       : 'verify',
		'query'	    : query,
		'bpath'	    : bpath,
		'stfile'    : stfile,
		'pdbfile'   : pdbfile,
	    }

        var request = $j.ajax({
        type: "POST",
        url: '/gui/verify_query/',
        cache: false,
        data: sndData,
        //async: false,
        });
		    
        request.done(function(Jdata) {
            var obj = $j.parseJSON(Jdata);
            $j("#density_frm_water #vfy_msg").empty().append("Verified!");
            $j("#dlg_selInfo #dlg_msg").empty().append(obj.selInfo);
	    $j("#dlg_selInfo").dialog({
		resizable: true,
		modal: true,
		height:500,
                width:600,
	    });

        });
          
        request.error(function(jqXHR, textStatus, errorThrown) {
            $j("#density_frm_water #vfy_msg").empty().append(errorThrown);
        });
    });

    //---> For water dipole 
    $j("#density_frm_waterdp #density_btn_vfy").click(function(){
	var query = $j("#membrane #density #density_frm_waterdp #density_query").val().trim();
	var bpath = $j("#proot option:selected").text().trim();
	var stfile = $j("#stfile option:selected").text().trim();
	var pdbfile = $j("#pdbfile option:selected").text().trim();
	
	var vfy = chkSyntex(query);
	if (vfy["flag"]) {
	    $j("#density_frm_waterdp #vfy_msg").empty().append(vfy["err"]);
	    return false;
	}
	/* display waiting message */
	var msgWait = "Verifying the query... <img src='/static/images/circle2.gif' height='20' width='20' >"
	
	
	$j("#density_frm_waterdp #vfy_msg").empty().append(msgWait);
	    var sndData = {
		'cmd'       : 'verify',
		'query'	    : query,
		'bpath'	    : bpath,
		'stfile'    : stfile,
		'pdbfile'   : pdbfile,
	    }

        var request = $j.ajax({
        type: "POST",
        url: '/gui/verify_query/',
        cache: false,
        data: sndData,
        //async: false,
        });
		    
        request.done(function(Jdata) {
            var obj = $j.parseJSON(Jdata);
            $j("#density_frm_waterdp #vfy_msg").empty().append("Verified!");
            $j("#dlg_selInfo #dlg_msg").empty().append(obj.selInfo);
	    $j("#dlg_selInfo").dialog({
		resizable: true,
		modal: true,
		height:500,
                width:600,
	    });

        });
          
        request.error(function(jqXHR, textStatus, errorThrown) {
            $j("#density_frm_waterdp #vfy_msg").empty().append(errorThrown);
        });
    });
    
    //---> For vector selection 
    $j("#density_frm_vector #density_btn_vfy").click(function(){
	var query = $j("#membrane #density #density_frm_vector #density_query").val().trim();
	var bpath = $j("#proot option:selected").text().trim();
	var stfile = $j("#stfile option:selected").text().trim();
	var pdbfile = $j("#pdbfile option:selected").text().trim();
	
	var vfy = chkSyntex(query);
	if (vfy["flag"]) {
	    $j("#density_frm_vector #vfy_msg").empty().append(vfy["err"]);
	    return false;
	}
	/* display waiting message */
	var msgWait = "Verifying the query... <img src='/static/images/circle2.gif' height='20' width='20' >"
	
	
	$j("#density_frm_vector #vfy_msg").empty().append(msgWait);
	    var sndData = {
		'cmd'       : 'verify',
		'query'	    : query,
		'bpath'	    : bpath,
		'stfile'    : stfile,
		'pdbfile'   : pdbfile,
	    }

        var request = $j.ajax({
        type: "POST",
        url: '/gui/verify_query/',
        cache: false,
        data: sndData,
        //async: false,
        });
		    
        request.done(function(Jdata) {
            var obj = $j.parseJSON(Jdata);
            $j("#density_frm_vector #vfy_msg").empty().append("Verified!");
            $j("#dlg_selInfo #dlg_msg").empty().append(obj.selInfo);
	    $j("#dlg_selInfo").dialog({
		resizable: true,
		modal: true,
		height:500,
                width:600,
	    });

        });
          
        request.error(function(jqXHR, textStatus, errorThrown) {
            $j("#density_frm_vector #vfy_msg").empty().append(errorThrown);
        });
    });
    
    //---> For custom selection 
    $j("#density_frm_custom #density_btn_vfy").click(function(){
	var query = $j("#membrane #density #density_frm_custom #density_query").val().trim();
	var bpath = $j("#proot option:selected").text().trim();
	var stfile = $j("#stfile option:selected").text().trim();
	var pdbfile = $j("#pdbfile option:selected").text().trim();
	
	var vfy = chkSyntex(query);
	if (vfy["flag"]) {
	    $j("#density_frm_custom #vfy_msg").empty().append(vfy["err"]);
	    return false;
	}
	/* display waiting message */
	var msgWait = "Verifying the query... <img src='/static/images/circle2.gif' height='20' width='20' >"
	
	
	$j("#vfy_msg").empty().append(msgWait);
	    var sndData = {
		'cmd'       : 'verify',
		'query'	    : query,
		'bpath'	    : bpath,
		'stfile'    : stfile,
		'pdbfile'   : pdbfile,
	    }

        var request = $j.ajax({
        type: "POST",
        url: '/gui/verify_query/',
        cache: false,
        data: sndData,
        //async: false,
        });
		    
        request.done(function(Jdata) {
            var obj = $j.parseJSON(Jdata);
            $j("#density_frm_custom #vfy_msg").empty().append("Verified!");
            $j("#dlg_selInfo #dlg_msg").empty().append(obj.selInfo);
	    $j("#dlg_selInfo").dialog({
		resizable: true,
		modal: true,
		height:500,
                width:600,
	    });

        });
          
        request.error(function(jqXHR, textStatus, errorThrown) {
            $j("#density_frm_custom #vfy_msg").empty().append(errorThrown);
        });
    });
});
</script>

<div id="membrane">
    <table>
	<tr>
	    <td colspan="2"><input type="checkbox" id="chk_membrane"><span class="st_font1 st_size3 st_color6"><b>Membrane(<span id="cnt_membrane" class="st_font1 st_size3 st_color5">0</span>)</b></span></td>
	</tr>
	<!--- Density --->
	<tr><td colspan="2">
	    <table id="M_membrane">
		<tr>
		    <td class="w_module"> </td>
		    <td>
			<div id="density">
			    <table>
				<tr>
				    <td colspan="2" class="st_color7 left">
					<input type="checkbox" id="density_title">Density Profiles<span id="density_read_pdb" class="message_warn"></span><br/><hr/>
				    </td>
				</tr>
			    </table>
			    <table id="density_form">
				<tr>
				    <td class="w_module"></td>
				    <td>
					<!--- START: density_all --->
					<table>
					    <tr>
						<td colspan=2><input type="checkbox" id="chk_density_all">all</td>
					    </tr>
					    <tr id="density_frm_all">
						<td class="w_module"></td>
						<td>
						    <table>
							<tr>
							    <td class="bottom"><span class="module_font">Frame Interval</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><span class="module_font">Output File Name</span></td>
							    <td class="bottom w15"></td>
							    <td></td><td></td><td></td><td></td><td></td>
							</tr>
							<tr>
							    <td class="bottom"><input id="density_frmInt" class="module_txtbox_output" type="text" name="density_frmInt"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom" colspan=7><input id="density_outFile" class="module_txtbox_output2" type="text" name="density_outFile"></td>
							</tr>
							<tr>
							    <td class="center"><span class="module_font">Axis</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Min</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Max</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Bin size</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"></td>
							</tr>
							<tr>
							    <td class="bottom">
								<select data-placeholder="Choose an axis" class="chzn-select" style="width:106px;" id="density_Axis_all" name="density_Axis_all">
								<option>Z</option>
								<option>Y</option>
								<option>X</option>
								</select>
							    </td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_min" class="module_txtbox_digit" type="text" name="density_hist_min"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_max" class="module_txtbox_digit" type="text" name="density_hist_max"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_bin" class="module_txtbox_digit" type="text" name="density_hist_bin"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_tatoms" type="hidden" name="density_hist_tatoms"></td>
							</tr>
							<tr>
							    <td class="left bottom" colspan=8><textarea class="bottom" id="density_query" name="density_query" rows="2" cols="64"></textarea></td>
							    <td class="bottom">
								<table>
								    <tr><td><button id="density_btn_vfy"><span class="module_font">Verify</span></button></td></tr>
								</table>
							    </td>
							</tr>
							<tr><td id="vfy_msg" class="center message_warn" colspan=5></td></tr>
						    </table>
						</td>
					    </tr>
					</table>
				    </td>
				</tr>
				<!--- END: density_all ----->
				
				<tr>
				    <td class="w_module"></td>
				    <td>
					<!--- START: lipid head --->
					<table>
					    <tr>
						<td colspan=2><input type="checkbox" id="chk_density_lipidH">lipid head (atom selection based on CHARMM force field)</td>
					    </tr>
					    <tr id="density_frm_lipidH">
						<td class="w_module"></td>
						<td>
						    <table>
							<tr>
							    <td class="bottom"><span class="module_font">Frame Interval</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><span class="module_font">Output File Name</span></td>
							    <td class="bottom w15"></td>
							    <td></td><td></td><td></td><td></td><td></td>
							</tr>
							<tr>
							    <td class="bottom"><input id="density_frmInt" class="module_txtbox_output" type="text" name="density_frmInt"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom" colspan=7><input id="density_outFile" class="module_txtbox_output2" type="text" name="density_outFile"></td>
							</tr>
							<tr>
							    <td class="center"><span class="module_font">Axis</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Min</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Max</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Bin size</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"></td>
							</tr>
							<tr>
							    <td class="bottom">
								<select data-placeholder="Choose an axis" class="chzn-select" style="width:106px;" id="density_Axis_lipidH" name="density_Axis_lipidH">
								<option>Z</option>
								<option>Y</option>
								<option>X</option>
								</select>
							    </td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_min" class="module_txtbox_digit" type="text" name="density_hist_min"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_max" class="module_txtbox_digit" type="text" name="density_hist_max"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_bin" class="module_txtbox_digit" type="text" name="density_hist_bin"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_tatoms" type="hidden" name="density_hist_tatoms"></td>
							</tr>
							<tr>
							    <td class="left bottom" colspan=8><textarea class="bottom" id="density_query" name="density_query" rows="2" cols="64"></textarea></td>
							    <td class="bottom">
								<table>
								    <tr><td><button id="density_btn_vfy"><span class="module_font">Verify</span></button></td></tr>
								</table>
							    </td>
							</tr>
							<tr><td id="vfy_msg" class="center message_warn" colspan=5></td></tr>
						    </table>
						</td>
					    </tr>
					</table>
				    </td>
				</tr>
				<!--- END: lipid head ----->
				
				<tr>
				    <td class="w_module"></td>
				    <td>
					<!--- START: lipid tail --->
					<table>
					    <tr>
						<td colspan=2><input type="checkbox" id="chk_density_lipidT">lipid tail (atom selection based on CHARMM force field)</td>
					    </tr>
					    <tr id="density_frm_lipidT">
						<td class="w_module"></td>
						<td>
						    <table>
							<tr>
							    <td class="bottom"><span class="module_font">Frame Interval</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><span class="module_font">Output File Name</span></td>
							    <td class="bottom w15"></td>
							    <td></td><td></td><td></td><td></td><td></td>
							</tr>
							<tr>
							    <td class="bottom"><input id="density_frmInt" class="module_txtbox_output" type="text" name="density_frmInt"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom" colspan=7><input id="density_outFile" class="module_txtbox_output2" type="text" name="density_outFile"></td>
							</tr>
							<tr>
							    <td class="center"><span class="module_font">Axis</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Min</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Max</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Bin size</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"></td>
							</tr>
							<tr>
							    <td class="bottom">
								<select data-placeholder="Choose an axis" class="chzn-select" style="width:106px;" id="density_Axis_lipidT" name="density_Axis_lipidT">
								<option>Z</option>
								<option>Y</option>
								<option>X</option>
								</select>
							    </td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_min" class="module_txtbox_digit" type="text" name="density_hist_min"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_max" class="module_txtbox_digit" type="text" name="density_hist_max"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_bin" class="module_txtbox_digit" type="text" name="density_hist_bin"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_tatoms" type="hidden" name="density_hist_tatoms"></td>
							</tr>
							<tr>
							    <td class="left bottom" colspan=8><textarea class="bottom" id="density_query" name="density_query" rows="2" cols="64"></textarea></td>
							    <td class="bottom">
								<table>
								    <tr><td><button id="density_btn_vfy"><span class="module_font">Verify</span></button></td></tr>
								</table>
							    </td>
							</tr>
							<tr><td id="vfy_msg" class="center message_warn" colspan=5></td></tr>
						    </table>
						</td>
					    </tr>
					</table>
				    </td>
				</tr>
				<!--- END: lipid tail ----->
				
				
				<tr>
				    <td class="w_module"></td>
				    <td>
					<!--- START: water --->
					<table>
					    <tr>
						<td colspan=2><input type="checkbox" id="chk_density_water">water</td>
					    </tr>
					    <tr id="density_frm_water">
						<td class="w_module"></td>
						<td>
						    <table>
							<tr>
							    <td class="bottom"><span class="module_font">Frame Interval</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><span class="module_font">Output File Name</span></td>
							    <td class="bottom w15"></td>
							    <td></td><td></td><td></td><td></td><td></td>
							</tr>
							<tr>
							    <td class="bottom"><input id="density_frmInt" class="module_txtbox_output" type="text" name="density_frmInt"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom" colspan=7><input id="density_outFile" class="module_txtbox_output2" type="text" name="density_outFile"></td>
							</tr>
							<tr>
							    <td class="center"><span class="module_font">Axis</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Min</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Max</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Bin size</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"></td>
							</tr>
							<tr>
							    <td class="bottom">
								<select data-placeholder="Choose an axis" class="chzn-select" style="width:106px;" id="density_Axis_water" name="density_Axis_water">
								<option>Z</option>
								<option>Y</option>
								<option>X</option>
								</select>
							    </td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_min" class="module_txtbox_digit" type="text" name="density_hist_min"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_max" class="module_txtbox_digit" type="text" name="density_hist_max"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_bin" class="module_txtbox_digit" type="text" name="density_hist_bin"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_tatoms" type="hidden" name="density_hist_tatoms"></td>
							</tr>
							<tr>
							    <td class="left bottom" colspan=8><textarea class="bottom" id="density_query" name="density_query" rows="2" cols="64"></textarea></td>
							    <td class="bottom">
								<table>
								    <tr><td><button id="density_btn_vfy"><span class="module_font">Verify</span></button></td></tr>
								</table>
							    </td>
							</tr>
							<tr><td id="vfy_msg" class="center message_warn" colspan=5></td></tr>
						    </table>
						</td>
					    </tr>
					</table>
				    </td>
				</tr>
				<!--- END: water ----->

				<tr>
				    <td class="w_module"></td>
				    <td>
					<!--- START: water dipole--->
					<table>
					    <tr>
						<td colspan=2><input type="checkbox" id="chk_density_waterdp">water dipole</td>
					    </tr>
					    <tr id="density_frm_waterdp">
						<td class="w_module"></td>
						<td>
						    <table>
							<tr>
							    <td class="bottom"><span class="module_font">Frame Interval</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><span class="module_font">Output File Name</span></td>
							    <td class="bottom w15"></td>
							    <td></td><td></td><td></td><td></td><td></td>
							</tr>
							<tr>
							    <td class="bottom"><input id="density_frmInt" class="module_txtbox_output" type="text" name="density_frmInt"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom" colspan=7><input id="density_outFile" class="module_txtbox_output2" type="text" name="density_outFile"></td>
							</tr>
							<tr>
							    <td class="center"><span class="module_font">Axis</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Min</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Max</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Bin size</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"></td>
							</tr>
							<tr>
							    <td class="bottom">
								<select data-placeholder="Choose an axis" class="chzn-select" style="width:106px;" id="density_Axis_waterdp" name="density_Axis_waterdp">
								<option>Z</option>
								<option>Y</option>
								<option>X</option>
								</select>
							    </td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_min" class="module_txtbox_digit" type="text" name="density_hist_min"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_max" class="module_txtbox_digit" type="text" name="density_hist_max"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_bin" class="module_txtbox_digit" type="text" name="density_hist_bin"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_tatoms" type="hidden" name="density_hist_tatoms"></td>
							</tr>
							<tr>
							    <td class="left bottom" colspan=8><textarea class="bottom" id="density_query" name="density_query" rows="2" cols="64"></textarea></td>
							    <td class="bottom">
								<table>
								    <tr><td><button id="density_btn_vfy"><span class="module_font">Verify</span></button></td></tr>
								</table>
							    </td>
							</tr>
							<tr><td id="vfy_msg" class="center message_warn" colspan=5></td></tr>
						    </table>
						</td>
					    </tr>
					</table>
				    </td>
				</tr>
				<!--- END: water dipole----->
				
				

				<tr>
				    <td class="w_module"></td>
				    <td>
					<!--- START: vector selection--->
					<table>
					    <tr>
						<td colspan=2><input type="checkbox" id="chk_density_vector">vector selection</td>
					    </tr>
					    <tr id="density_frm_vector">
						<td class="w_module"></td>
						<td>
						    <table>
							<tr>
							    <td class="bottom"><span class="module_font">Frame Interval</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><span class="module_font">Output File Name</span></td>
							    <td class="bottom w15"></td>
							    <td></td><td></td><td></td><td></td><td></td>
							</tr>
							<tr>
							    <td class="bottom"><input id="density_frmInt" class="module_txtbox_output" type="text" name="density_frmInt"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom" colspan=7><input id="density_outFile" class="module_txtbox_output2" type="text" name="density_outFile"></td>
							</tr>
							<tr>
							    <td class="center"><span class="module_font">Axis</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Min</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Max</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Bin size</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"></td>
							</tr>
							<tr>
							    <td class="bottom">
								<select data-placeholder="Choose an axis" class="chzn-select" style="width:106px;" id="density_Axis_vector" name="density_Axis_vector">
								<option>Z</option>
								<option>Y</option>
								<option>X</option>
								</select>
							    </td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_min" class="module_txtbox_digit" type="text" name="density_hist_min"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_max" class="module_txtbox_digit" type="text" name="density_hist_max"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_bin" class="module_txtbox_digit" type="text" name="density_hist_bin"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_tatoms" type="hidden" name="density_hist_tatoms"></td>
							</tr>
							<tr>
							    <td class="left bottom" colspan=8><textarea class="bottom" id="density_query" name="density_query" rows="2" cols="64"></textarea></td>
							    <td class="bottom">
								<table>
								    <tr><td><button id="density_btn_vfy"><span class="module_font">Verify</span></button></td></tr>
								</table>
							    </td>
							</tr>
							<tr><td id="vfy_msg" class="center message_warn" colspan=5></td></tr>
						    </table>
						</td>
					    </tr>
					</table>
				    </td>
				</tr>
				<!--- END: vector selection----->

				<tr>
				    <td class="w_module"></td>
				    <td>
					<!--- START: custom selection--->
					<table>
					    <tr>
						<td colspan=2><input type="checkbox" id="chk_density_custom">custom selection</td>
					    </tr>
					    <tr id="density_frm_custom">
						<td class="w_module"></td>
						<td>
						    <table>
							<tr>
							    <td class="bottom"><span class="module_font">Frame Interval</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><span class="module_font">Output File Name</span></td>
							    <td class="bottom w15"></td>
							    <td></td><td></td><td></td><td></td><td></td>
							</tr>
							<tr>
							    <td class="bottom"><input id="density_frmInt" class="module_txtbox_output" type="text" name="density_frmInt"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom" colspan=7><input id="density_outFile" class="module_txtbox_output2" type="text" name="density_outFile"></td>
							</tr>
							<tr>
							    <td class="center"><span class="module_font">Axis</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Min</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Max</span></td>
							    <td class="bottom w15"></td>
							    <td class="center"><span class="module_font">Bin size</span></td>
							    <td class="bottom w15"></td>
							    <td class="bottom"></td>
							</tr>
							<tr>
							    <td class="bottom">
								<select data-placeholder="Choose an axis" class="chzn-select" style="width:106px;" id="density_Axis_custom" name="density_Axis_custom">
								<option>Z</option>
								<option>Y</option>
								<option>X</option>
								</select>
							    </td>
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_min" class="module_txtbox_digit" type="text" name="density_hist_min"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_max" class="module_txtbox_digit" type="text" name="density_hist_max"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_bin" class="module_txtbox_digit" type="text" name="density_hist_bin"></td>	
							    <td class="bottom w15"></td>
							    <td class="bottom"><input id="density_hist_tatoms" type="hidden" name="density_hist_tatoms"></td>
							</tr>
							<tr>
							    <td class="left bottom" colspan=8><textarea class="bottom" id="density_query" name="density_query" rows="2" cols="64"></textarea></td>
							    <td class="bottom">
								<table>
								    <tr><td><button id="density_btn_vfy"><span class="module_font">Verify</span></button></td></tr>
								    <tr><td><input type="checkbox" id="density_gquery">use GUI</td></tr>
								</table>
							    </td>
							</tr>
							<!--- GUI query builder --->
							<tr id="density_gui_input">
							    <td colspan=9>
							    <table>
								<tr>
								    <td>
									<table>
									    <tr>
										<td><button id="btn_selall" class="button_2letter">ALL</button></td>
										<td><button id="btn_lt" class="button_2letter"><</button></td>
										<td><button id="btn_gt" class="button_2letter">></button></td>
										<td><button id="btn_eq" class="button_2letter">==</button></td>
										<td><button id="btn_ne" class="button_2letter">!=</button></td>
										<td><button id="btn_ge" class="button_2letter">>=</button></td>
										<td><button id="btn_le" class="button_2letter"><=</button></td>
										<td><button id="btn_and" class="button_2letter">AND</button></td>
										<td><button id="btn_or" class="button_2letter">OR</button></td>
										<td><button id="btn_not" class="button_2letter">NOT</button></td>
										<td><button id="btn_around" class="button_2letter">AROUND</button></td>
										<td><button id="btn_query_segid" class="button_2letter">SEGID</button></td>
									    </tr>
									</table>
								    </td>
								</tr>
								<tr>
								    <td>
									<table>
									    <tr>
										<td><button id="btn_query_resname" class="button_2letter">RESNAME</button></td>
										<td><button id="btn_query_resid" class="button_2letter">RESID</button></td>
										<td><button id="btn_query_name" class="button_2letter">NAME</button></td>
										<td><button id="btn_query_type" class="button_2letter">TYPE</button></td>
										<td><button id="btn_query_prop" class="button_2letter">PROP</button></td>
										<!-- <td><button id="btn_query_all" class="button_2letter">ALL</button></td> -->
										<td></td>
									    </tr>
									</table>
								    </td>
								</tr>
								<tr>
								    <td>
									<table>
									    <tr>
										<td>
										    <select data-placeholder="key words" class="chzn-select" style="width:100px;" id="keywords" name="keywords"></select>
										    <button id="btn_add_keywords">Add</button>
										</td>
										<td>
										    <select data-placeholder="segid" class="chzn-select" style="width:100px;" id="uq_segid" name="uq_segid"></select>
										    <button id="btn_add_segid">Add</button>
										</td>
										<td class="w15"></td>
										<td rowspan=3><div id="quick_help"></div></td>
									    </tr>
									    <tr>
										<td>
										    <select data-placeholder="resname" class="chzn-select" style="width:100px;" id="uq_resname" name="uq_resname"></select>
										    <button id="btn_add_resname">Add</button>
										</td>
										<td>
										    <select data-placeholder="resid" class="chzn-select" style="width:100px;" id="uq_resid" name="uq_resid"></select>
										    <button id="btn_add_resid">Add</button><span id="st_load"></span>
										</td>
										<td class="w15"></td>
									    </tr>
									    <tr>
										<td>
										    <select data-placeholder="name" class="chzn-select" style="width:100px;" id="uq_name" name="uq_name"></select>
										    <button id="btn_add_name">Add</button>
										</td>
										<td>
										    <select data-placeholder="type" class="chzn-select" style="width:100px;" id="uq_type" name="uq_type"></select>
										    <button id="btn_add_type">Add</button>
										</td>
										<td class="w15"></td>
									    </tr>
									</table>
								    </td>
								</tr>
							    </table>
							    </td>
							</tr>
							<tr><td id="vfy_msg" class="center message_warn" colspan=5></td></tr>
						    </table>
						</td>
					    </tr>
					</table>
				    </td>
				</tr>
				<!--- END: custom selection----->

			    </table>
			</div>
		    </td>
		</tr>
	    </table>
	</td></tr>
	<!--- Density end--->
    </table>
</div>

